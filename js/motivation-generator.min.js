function motgen_load_image(b){function e(){a=new Image;a.id="motgen_raw_background_picture";a.onload=m;a.src=h.result;a.style.display="none";for(var b=document.getElementById("motgen_raw_background_placeholder");b.firstChild;)b.removeChild(b.firstChild);b.insertBefore(a,b.firstChild)}function m(){function b(d,c){f.fillStyle="#000000";f.fillRect(0,0,g.width,g.height);var k,e=0;a.height>a.width?(k=parseInt(a.height/90),e=parseInt(a.height/167)):(k=parseInt(a.width/90),e=parseInt(a.width/167));11>k&&
(k=11);3>e&&(e=3);f.lineWidth=e;f.strokeStyle="white";f.rect(d-k,a.height/10-k,a.width+2*k,a.height+2*k);f.stroke();c()}function h(b,e){f.drawImage(a,b,a.height/10);var d=new Image;d.id="motgen_background_picture";d.src=g.toDataURL();d.style.display="none";for(var c=document.getElementById("motgen_poster_placeholder");c.firstChild;)c.removeChild(c.firstChild);c.insertBefore(d,c.firstChild);e()}var c=parseInt(document.getElementById("motgen_mainline_font_size").value),e=parseInt(document.getElementById("motgen_subline_font_size").value);
isNaN(c)&&(c=60);isNaN(e)&&(e=60);(function(b){g.style.position="inherit";g.width=1<a.width/a.height?a.width+a.width/5:a.width+a.width/3;g.height=a.height+(2*c+e)+a.height/10+c/2;b()})(function(){var c=g.width/2-a.width/2;b(c,function(){h(c,function(){g.style.display="block";document.getElementById("motgen_generator_form").style.display="block";d.style.display="none";motgen_type_text()})})})}function c(b){for(var a=document.getElementById("motgen_error_message_area");a.firstChild;)a.removeChild(a.firstChild);
var c=document.createElement("p");c.innerHTML=b;a.appendChild(c);a.style.display="block"}var d=document.getElementById("motgen_loading_icon");d.style.display="inline";var g=document.getElementById("motgen_poster_canvas"),f=g.getContext("2d");g.style.display="none";if("font"===b){var a=document.getElementById("motgen_raw_background_picture");m()}else{var h;if("function"!==typeof window.FileReader)c("Hey, Your browser seems out of date.");else if(b=document.getElementById("motgen_imgfile"))if(b.files)if(b.files[0])if(b.files[0].type.match("image.*"))document.getElementById("motgen_error_message_area").style.display=
"none",b=b.files[0],h=new FileReader,h.onload=e,h.readAsDataURL(b);else{d.style.display="none";c("This is not am image. Please select an image file.");for(b=document.getElementById("motgen_poster_placeholder");b.firstChild;)b.removeChild(b.firstChild);document.getElementById("motgen_generator_form").style.display="none"}else d.style.display="none",c("Please select a file first.");else d.style.display="none",c("Hey, Your browser seems out of date.");else d.style.display="none",c("Um, it seems that there is no file input element.")}}
function motgen_type_text(){var b=parseInt(document.getElementById("motgen_mainline_font_size").value),e=parseInt(document.getElementById("motgen_subline_font_size").value),m=document.getElementById("motgen_poster_mainline").value,c=document.getElementById("motgen_poster_subline").value,d=document.getElementById("motgen_poster_canvas"),g=document.getElementById("motgen_background_picture");isNaN(b)&&(b=60);isNaN(e)&&(e=60);var f=d.getContext("2d");f.clearRect(0,0,d.width,d.height);f.drawImage(g,0,
0);f.font=b+"px FreeSerif";f.textAlign="center";f.fillStyle="white";var g=b/2,a=2*b+e,h=d.width/2;if(0==c.trim().length){var l=d.height-(g+a)/2+b/2;f.fillText(m.toUpperCase(),h,l)}else 0==m.trim().length?(l=d.height-(g+a)/2+b/2,f.fillText(c.toUpperCase(),h,l)):(l=d.height-(g+a)/2+b/2-e,f.fillText(m.toUpperCase(),h,l),l=d.height-(g+a)/2+b/2+e/2,f.font=e+"px FreeSerif",f.fillText(c,h,l))}
function motgen_submit_poster(){0!=document.getElementById("motgen_poster_mainline").value.trim().length&&(document.getElementById("motgen_created_poster").value=document.getElementById("motgen_poster_canvas").toDataURL("image/jpeg"),document.forms.motgen_generator_form.submit())};